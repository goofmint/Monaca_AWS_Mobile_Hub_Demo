<ons-page id="info">
  <ons-toolbar>
    <div class="center">Your info</div>
    <div class="right">
      <ons-icon icon="fa-sign-out" id="logout"></ons-icon>
    </div>
  </ons-toolbar>
  <div style="text-align: center; margin-top: 30px;">
    <h1>Welcome, <span id="username_label"></span></h1>
  </div>    
  <script>
    document.addEventListener('show', (event) => {
      const page = event.target;
      if (page.id !== 'info') return;
      Auth.currentSession()
        .then(session => {
          const user = JSON.parse(window.atob(session.accessToken.jwtToken.split('.')[1]));
          page.querySelector('#username_label').innerHTML = user.username;
        }, err => console.log(err));
    });
    document.addEventListener('init', (event) => {
      const page = event.target;
      if (page.id !== 'info') return;
      page.querySelector('#logout').onclick = (e) => {
        Auth.signOut()
          .then(() => document.getElementById('nav').resetToPage('signup.html'))
      }
    });
  </script>
</ons-page>
